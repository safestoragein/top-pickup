<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bangalore Pickup Analysis - Clean Apartment Names</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card .icon {
            font-size: 2rem;
            margin-bottom: 15px;
        }

        .stat-card.total .icon { color: #3498db; }
        .stat-card.areas .icon { color: #e74c3c; }
        .stat-card.apts .icon { color: #27ae60; }
        .stat-card.single .icon { color: #f39c12; }

        .stat-card h3 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .stat-card p {
            color: #666;
            font-size: 0.9rem;
        }

        .controls {
            padding: 30px;
            background: white;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .search-box {
            position: relative;
            flex: 1;
            min-width: 300px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 15px 12px 45px;
            border: 2px solid #ddd;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .search-box input:focus {
            border-color: #3498db;
        }

        .search-box .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

        .export-btn {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(39, 174, 96, 0.3);
        }

        .table-container {
            padding: 0 30px 30px;
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .data-table thead {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
        }

        .data-table th {
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .data-table td {
            padding: 12px 10px;
            border-bottom: 1px solid #eee;
            vertical-align: top;
            font-size: 0.85rem;
        }

        .data-table tbody tr:hover {
            background: #f8f9fa;
        }

        .rank-cell {
            text-align: center;
            font-weight: 700;
            color: #3498db;
            font-size: 1.1rem;
        }

        .area-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1rem;
        }

        .bookings {
            font-weight: 600;
            color: #27ae60;
        }

        .percentage {
            font-size: 0.8rem;
            color: #666;
        }

        .areas-column {
            line-height: 1.3;
            max-height: 250px;
            overflow-y: auto;
        }

        .area-section {
            margin-bottom: 8px;
        }

        .area-section-header {
            font-weight: 600;
            font-size: 0.75rem;
            margin-bottom: 3px;
            text-transform: uppercase;
        }

        .area-section-header.sub-areas { color: #3498db; }
        .area-section-header.roads { color: #e74c3c; }
        .area-section-header.landmarks { color: #f39c12; }

        .area-item {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 6px;
            font-size: 0.7rem;
            margin: 1px;
            display: inline-block;
            border-left: 3px solid #ddd;
        }

        .area-item.sub-area { border-left-color: #3498db; background: #e3f2fd; }
        .area-item.road { border-left-color: #e74c3c; background: #ffebee; }
        .area-item.landmark { border-left-color: #f39c12; background: #fff8e1; }

        .apartments {
            line-height: 1.4;
            max-height: 300px;
            overflow-y: auto;
        }

        .apartment-item {
            background: #ecf0f1;
            padding: 6px 10px;
            border-radius: 8px;
            font-size: 0.8rem;
            margin: 3px;
            display: inline-block;
            word-break: break-word;
            max-width: 100%;
            font-weight: 500;
        }

        .apartment-count {
            background: #3498db;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            margin-left: 6px;
            font-weight: bold;
        }

        .high-pickup {
            border-left: 4px solid #27ae60;
            background: #e8f5e8;
        }

        .medium-pickup {
            border-left: 4px solid #f39c12;
            background: #fef9e7;
        }

        .single-pickup {
            border-left: 4px solid #95a5a6;
            background: #f8f9fa;
        }

        .section-header {
            font-weight: 600;
            margin: 8px 0 4px 0;
            font-size: 0.75rem;
            text-transform: uppercase;
            display: block;
            width: 100%;
        }

        .section-header.high { color: #27ae60; }
        .section-header.medium { color: #f39c12; }
        .section-header.single { color: #95a5a6; }

        .stats-summary {
            background: #f1f2f6;
            padding: 8px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .show-more-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.7rem;
            cursor: pointer;
            margin: 5px 2px;
            transition: all 0.3s ease;
        }

        .show-more-btn:hover {
            background: #2980b9;
            transform: scale(1.05);
        }

        .hidden-apartments {
            display: none;
        }

        .hidden-apartments.show {
            display: inline;
        }

        @media (max-width: 1200px) {
            .data-table th,
            .data-table td {
                padding: 8px 5px;
                font-size: 0.75rem;
            }
            
            .apartment-item {
                font-size: 0.75rem;
                padding: 4px 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-building"></i> Bangalore Pickup Analysis</h1>
            <p>Clean apartment names only ‚Ä¢ Areas breakdown ‚Ä¢ 459 apartment complexes</p>
        </div>

        <div class="stats-container">
            <div class="stat-card total">
                <div class="icon"><i class="fas fa-chart-bar"></i></div>
                <h3>3,266</h3>
                <p>Total Pickup Records</p>
            </div>
            <div class="stat-card areas">
                <div class="icon"><i class="fas fa-map"></i></div>
                <h3>15</h3>
                <p>Top Areas</p>
            </div>
            <div class="stat-card apts">
                <div class="icon"><i class="fas fa-building"></i></div>
                <h3>459</h3>
                <p>Total Apartments</p>
            </div>
            <div class="stat-card single">
                <div class="icon"><i class="fas fa-home"></i></div>
                <h3>397</h3>
                <p>Single Pickup Apartments</p>
            </div>
        </div>

        <div class="controls">
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text" id="searchInput" placeholder="Search by area, apartment name, road...">
            </div>
            <button class="export-btn" onclick="exportToExcel()">
                <i class="fas fa-download"></i>
                Export All
            </button>
        </div>

        <div class="table-container">
            <table class="data-table" id="dataTable">
                <thead>
                    <tr>
                        <th width="5%">Rank</th>
                        <th width="12%">Area</th>
                        <th width="8%">Bookings</th>
                        <th width="25%">Areas (Sub-areas ‚Ä¢ Roads ‚Ä¢ Landmarks)</th>
                        <th width="50%">Apartment Names Only (Clean Names ‚Ä¢ Expandable)</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Data will be populated by JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <script>
        // Final apartment data with clean names only
const pickupData = [
    {
        rank: 1,
        area: "Unknown",
        bookings: 1672,
        percentage: 51.2,
        areaDetails: {
            subAreas: [],
            roads: [],
            landmarks: []
        },
        apartmentsHigh: [{"name": "Apartment Complex", "count": 11}, {"name": "Embassy Golf Links", "count": 10}, {"name": "Dlf Westend", "count": 4}, {"name": "Provident Park Square", "count": 3}, {"name": "Sobha Dream Acres", "count": 3}, {"name": "Mantri Tranquil Mantri Tranquil", "count": 3}, {"name": "Prestige Finsbury Park", "count": 3}, {"name": "Brigade Metropolis", "count": 3}, {"name": "Sjr Blue Waters Clarence", "count": 3}, {"name": "Johns Road Hermit", "count": 3}],
        apartmentsMedium: [{"name": "Nd Stage", "count": 2}, {"name": "Green Acres Kalena Agrahara", "count": 2}, {"name": "Telecom Layout Jakkuru", "count": 2}, {"name": "Shriram Greenfield Hobli", "count": 2}, {"name": "Vinayaka Nagar Nanjundeswara", "count": 2}, {"name": "Sobha Dream", "count": 2}, {"name": "Pride Pegasus Visthar", "count": 2}, {"name": "Purva Westend Service", "count": 2}, {"name": "Thimappa Reddy", "count": 2}, {"name": "Kots Jour Byreshwara", "count": 2}, {"name": "Hiranandani Villas Devanahalli North", "count": 2}, {"name": "Bda Layout", "count": 2}, {"name": "Th Block Kormangala", "count": 2}, {"name": "Pbr", "count": 2}, {"name": "Garden Murugeshpalya", "count": 2}, {"name": "Brigade Cornerstone Utopia", "count": 2}],
        apartmentsSingle: [{"name": "Ncr", "count": 1}, {"name": "Sector 92 Gurugram Haryana India", "count": 1}, {"name": "Apartment Complex", "count": 1}, {"name": "Dlf Woodland", "count": 1}, {"name": "Abbaiah Reddy", "count": 1}, {"name": "Sobha Dream Acres", "count": 1}, {"name": "Nd Block Bda", "count": 1}, {"name": "Glenwood Prestige Glenwood Mandur", "count": 1}, {"name": "Sneha Grandeur Subbanna", "count": 1}, {"name": "Knss Colony Horamavu", "count": 1}, {"name": "Srinivasam", "count": 1}, {"name": "Sobha Coral Behind Jakkur Jakkuru", "count": 1}, {"name": "Diya Apartment Reliable", "count": 1}, {"name": "Godrej United", "count": 1}, {"name": "5th Block", "count": 1}, {"name": "Arkavathy Layout Thanisandra", "count": 1}, {"name": "Reliable Lake Dew", "count": 1}, {"name": "Prestige Lake Ridge Thurahalli", "count": 1}, {"name": "Chourasia", "count": 1}, {"name": "Sannidhi", "count": 1}, {"name": "Sobha Dream Acres Balagere", "count": 1}, {"name": "Vijaya Bank", "count": 1}, {"name": "Aecs Layout Singasandra", "count": 1}, {"name": "Towers Owners Court", "count": 1}, {"name": "Naveen", "count": 1}, {"name": "Bangalore Anekal Rd Anekal", "count": 1}, {"name": "Karpagam Garden", "count": 1}, {"name": "Sneha Grandeur Hoodi", "count": 1}, {"name": "Zenith Residences Dadamastan", "count": 1}, {"name": "Sobha City Sobha City", "count": 1}, {"name": "Skyline", "count": 1}, {"name": "Vtp Belair Bluewaters", "count": 1}, {"name": "Lakshmi Layout Arekere", "count": 1}, {"name": "St Floor Sumahesh", "count": 1}, {"name": "Block Begur", "count": 1}, {"name": "Gokul", "count": 1}, {"name": "Green Garden", "count": 1}, {"name": "Sushila", "count": 1}, {"name": "Tower", "count": 1}, {"name": "Silver Springs", "count": 1}, {"name": "Fifth Element Gunjur", "count": 1}, {"name": "Adithya Palatial", "count": 1}, {"name": "Kothanur Rammana", "count": 1}, {"name": "Avalappa Layout Ammanamma", "count": 1}, {"name": "Fifth Element Apartment Gunjur", "count": 1}, {"name": "Vishnu", "count": 1}, {"name": "Nri Layout", "count": 1}, {"name": "Purva Promenade Hennur", "count": 1}, {"name": "Alsa Terraces Langford", "count": 1}, {"name": "Mico Layout Hongasandra", "count": 1}, {"name": "Bharath Housing Society", "count": 1}, {"name": "Sobha Ruby Platinum Tumkur", "count": 1}, {"name": "St Stage", "count": 1}, {"name": "Ranches Sai Sree", "count": 1}, {"name": "Sobha Apartments Nagasandra", "count": 1}, {"name": "Home Isro", "count": 1}, {"name": "Apartment Complex", "count": 1}, {"name": "Royal Slv", "count": 1}, {"name": "Amr Oaks Apartment Iggaluru", "count": 1}, {"name": "United Green City", "count": 1}, {"name": "Shriram Sameeksha Shriniketh", "count": 1}, {"name": "Prestige Oasis Adde", "count": 1}, {"name": "Jala Hobli Gummanahalli Bagaluru", "count": 1}, {"name": "Rd Kudlu Aecs", "count": 1}, {"name": "Sobha City Thanisandra", "count": 1}, {"name": "Kumari Brundavan 18Th", "count": 1}, {"name": "Hiranandani Akshaya Gardens Akshayanagar", "count": 1}, {"name": "Prestige Lakeside Habitat Gunjur Village", "count": 1}, {"name": "Hilal Nagar Hbr", "count": 1}, {"name": "Nest Vijaya Bank", "count": 1}, {"name": "Vaattika Doctors", "count": 1}, {"name": "Prestige Song Of The South", "count": 1}, {"name": "Purva Skywood Silver County", "count": 1}, {"name": "Clayton St Devasthanagalu Gunjur", "count": 1}, {"name": "Mahalakshmi Layout", "count": 1}, {"name": "Dlf Maiden", "count": 1}, {"name": "Dlf City", "count": 1}, {"name": "Wing Vani Apartment Wadiwali", "count": 1}, {"name": "Home Pragathi", "count": 1}, {"name": "Sobha Garrison Tumkur", "count": 1}, {"name": "Brigade Meadows Kanakapura", "count": 1}, {"name": "Dlf Woodland", "count": 1}, {"name": "Pride", "count": 1}, {"name": "Ganesha Block Nandini", "count": 1}, {"name": "Mithila", "count": 1}, {"name": "Brigade Golden Triangle", "count": 1}, {"name": "Road Green Garden", "count": 1}, {"name": "Road Silver Springs", "count": 1}, {"name": "Road Hanumanthappa", "count": 1}, {"name": "Sobha Eternia Haralur", "count": 1}, {"name": "Rd Carmelaram Janatha", "count": 1}, {"name": "Naidu Layout Chikkalasandra", "count": 1}, {"name": "Arekere Mico", "count": 1}, {"name": "Lakshmi Layout Arekere", "count": 1}, {"name": "Reddy Avenue Ngr", "count": 1}, {"name": "Marks Hotel &", "count": 1}, {"name": "Sjr Bluewaters Haralur", "count": 1}, {"name": "Sobha Dream Acres", "count": 1}, {"name": "Cloud", "count": 1}, {"name": "Ruby", "count": 1}, {"name": "Asr", "count": 1}, {"name": "Isro Layout Rajeshwari", "count": 1}, {"name": "Sjr Primecorp Silver County", "count": 1}, {"name": "Chervith", "count": 1}, {"name": "Prestige Lake Ridge", "count": 1}, {"name": "Chinnappanahalli Hanuma Reddy", "count": 1}, {"name": "Khosala Silver Spring", "count": 1}, {"name": "Habitat Eden", "count": 1}, {"name": "Spring Leaf", "count": 1}, {"name": "Prestige Tranquility Budigere", "count": 1}, {"name": "Cambridge Layout Jogupalya", "count": 1}, {"name": "Prestige Royale Gardens Doddaballapur", "count": 1}, {"name": "Pruthvi Layout Channasandra", "count": 1}, {"name": "Srj", "count": 1}, {"name": "Prestige Ferns", "count": 1}, {"name": "Southern Winds", "count": 1}, {"name": "Sri Sai", "count": 1}, {"name": "Home Aecs", "count": 1}, {"name": "Nikoo", "count": 1}, {"name": "Sai Ganesh", "count": 1}, {"name": "Saroj Symphony", "count": 1}, {"name": "Prestige Mayberry", "count": 1}, {"name": "Pragathi Layout Doddanekundi", "count": 1}, {"name": "Shriram Chirping Woods Eastwood Township", "count": 1}, {"name": "Sobha Dream Acres", "count": 1}, {"name": "Shriram Blue", "count": 1}, {"name": "Prestige Bella Vista Poonamallee", "count": 1}, {"name": "Baldota Serenity Venkataswamy", "count": 1}, {"name": "Prestige Casabella Neeladri", "count": 1}, {"name": "Telecom Layout Hbr", "count": 1}, {"name": "Green Garden", "count": 1}, {"name": "Gvr Oaks Ardendale Kannamangala", "count": 1}, {"name": "Block N2 Flat", "count": 1}, {"name": "Mykonos Devin Paradise", "count": 1}, {"name": "Green House", "count": 1}, {"name": "Near Vijaya Bank", "count": 1}, {"name": "Ckr", "count": 1}, {"name": "Purva Venezia Vignana Kendra", "count": 1}, {"name": "Heights North Punappa", "count": 1}, {"name": "Rrmr", "count": 1}, {"name": "Dommasandra Rd Janatha", "count": 1}, {"name": "Nd Phase Talaghattapura", "count": 1}, {"name": "Ab Nivasa Joseph", "count": 1}, {"name": "Brigade Buena Vista Budigere", "count": 1}, {"name": "Near Bagmane Kamadhenu", "count": 1}, {"name": "Btr", "count": 1}, {"name": "Assetz Marq", "count": 1}, {"name": "Bbt Factory Nanjappa", "count": 1}, {"name": "Rd Block Hbr", "count": 1}, {"name": "Boulevard Post Sonam", "count": 1}, {"name": "Rd Stage Puttappa", "count": 1}, {"name": "Dlf Phase", "count": 1}, {"name": "Sobha Dream Acres", "count": 1}, {"name": "Brigade Orchards Devanahalli", "count": 1}, {"name": "A Block Aecs", "count": 1}, {"name": "Shri Kempanna", "count": 1}, {"name": "Stage Bhoomi Reddy", "count": 1}, {"name": "Sree Jd", "count": 1}, {"name": "Venkatappa Layout Postal", "count": 1}, {"name": "Brigade Eldorado Gummanahalli", "count": 1}, {"name": "Pooja", "count": 1}, {"name": "Mvrs", "count": 1}, {"name": "Swapna", "count": 1}, {"name": "Bidare Agrahara", "count": 1}, {"name": "Nilayam Carmelaram Janatha", "count": 1}, {"name": "Rd Block Hbr", "count": 1}, {"name": "Aagama", "count": 1}, {"name": "Brigade Buena Vista Budigere", "count": 1}, {"name": "Jbn", "count": 1}, {"name": "Vaishnavi Terrace Dollars", "count": 1}, {"name": "Bda Layout", "count": 1}, {"name": "Town Kudlu Vgp", "count": 1}, {"name": "Chikkadunnasandra Kada Agrahara", "count": 1}, {"name": "Rama Villas Reliable", "count": 1}, {"name": "Shreyas Residency Btr", "count": 1}, {"name": "Shree Gatti", "count": 1}, {"name": "Nbr Lallu", "count": 1}, {"name": "Ds Max Springfield", "count": 1}, {"name": "Sri Balaji", "count": 1}, {"name": "Verdant Hobli Janatha", "count": 1}, {"name": "Sepal", "count": 1}, {"name": "Sree Sai", "count": 1}, {"name": "Garuda Vista", "count": 1}, {"name": "Manchester Anthem Prasanth", "count": 1}, {"name": "Sector 75 Noida Uttar Pradesh 201301\u00ac\u221154", "count": 1}, {"name": "Purva Skywood Silver County", "count": 1}, {"name": "Godrej Royale Woods Devanahalli", "count": 1}, {"name": "Tarun Nilayam Munnekolal Near Ishan", "count": 1}, {"name": "Vybhav", "count": 1}, {"name": "Gopalan Sanskriti", "count": 1}, {"name": "Meadows Silver Spring", "count": 1}, {"name": "Salarpuria Sattva Greenage Begur", "count": 1}, {"name": "Edgewaters Owners Court", "count": 1}, {"name": "Kumaraswamy Layout", "count": 1}, {"name": "Silver Springs", "count": 1}, {"name": "Mantri Lithos Thanisandra", "count": 1}, {"name": "Rd Classic Paradise", "count": 1}, {"name": "Royal", "count": 1}, {"name": "Ias Layout Eastwood Township", "count": 1}, {"name": "Aahika Apartment", "count": 1}, {"name": "Kapishhouse Jcr", "count": 1}, {"name": "Anugraha Layout Ramanashree", "count": 1}, {"name": "Lendee Sentosa Adarsh Palm", "count": 1}, {"name": "Township", "count": 1}, {"name": "Salarpuria Cadenza", "count": 1}, {"name": "Lake Point Tower Lake Point", "count": 1}, {"name": "Chelston Silver Springs", "count": 1}, {"name": "Koppa Road Chandrashekarapura", "count": 1}, {"name": "Slv", "count": 1}, {"name": "Dinne Lords Steps", "count": 1}, {"name": "Shoba Dream Acres Balagere", "count": 1}, {"name": "Ksm", "count": 1}, {"name": "Prestige Tranquility Budigere", "count": 1}, {"name": "Prestige Finsbury Park", "count": 1}, {"name": "Sarojini", "count": 1}, {"name": "Kommaghatta Bda Flats.", "count": 1}, {"name": "Sobha Arena Kanakapura", "count": 1}, {"name": "South City", "count": 1}, {"name": "Ah Residency Thomas", "count": 1}, {"name": "Park Hyde Gummanahalli Bagalur", "count": 1}, {"name": "Kudlu Gate Munireddy", "count": 1}, {"name": "Prestige Finsbury Park", "count": 1}, {"name": "Princeville", "count": 1}],
        totalApartments: 249,
        singlePickupCount: 223
    },
    {
        rank: 2,
        area: "Whitefield",
        bookings: 259,
        percentage: 7.9,
        areaDetails: {
            subAreas: ["Ambedkar Nagar", "Byrappa Layout", "Prasanth Extension", "Road Phase 2", "Prestige Park", "Springdale Layout", "Narayanswamy Layout", "Gopalan Colony"],
            roads: ["Whitefield Main Road", "2Nd Main", "2Nd Cross Road", "1St Cross", "Belathur Main Road", "Nallurahalli Main Road"],
            landmarks: ["Near Nurture International School", "Garudacharapalya Metro Station", "Near Holy Cross School", "Outer Circle"]
        },
        apartmentsHigh: [{"name": "Varthur Kodi Palm Meadows", "count": 4}, {"name": "Prestige Lakeside Habitat", "count": 3}],
        apartmentsMedium: [{"name": "Prestige Waterford", "count": 2}],
        apartmentsSingle: [{"name": "Prestige Silver Oak", "count": 1}, {"name": "White Rose", "count": 1}, {"name": "Sri Balaji Sunflower", "count": 1}, {"name": "Apartment Summer", "count": 1}, {"name": "Reddy", "count": 1}, {"name": "Prasanth Layout Prasanth Extension", "count": 1}, {"name": "Prestige Ozone", "count": 1}, {"name": "Wild Jasmine", "count": 1}, {"name": "Vinayaka Layout Whitefield", "count": 1}, {"name": "Brigade Lakefront Seetharama", "count": 1}, {"name": "Nallurahalli Palm Meadows Village", "count": 1}, {"name": "Prithvi Layout Whitefield", "count": 1}, {"name": "First Floor Sri Mahalasa", "count": 1}, {"name": "Brigade Woods Ecc", "count": 1}, {"name": "Th Floor Neil Tower Of Neil Rao", "count": 1}, {"name": "Dwarakamai Nilayam Palm Meadows", "count": 1}, {"name": "Near Sap Labs Seetharampalya", "count": 1}, {"name": "Sobha Habitech", "count": 1}, {"name": "Dodsworth Layout Whitefield", "count": 1}, {"name": "Ittina Anu", "count": 1}, {"name": "Dodsworth Layout Whitefield", "count": 1}, {"name": "Palm Meadows Whitefield", "count": 1}, {"name": "Sap Labs Epip Zone", "count": 1}, {"name": "White Rose", "count": 1}, {"name": "Dsr Green Vista", "count": 1}, {"name": "Upkar Layout Whitefield", "count": 1}, {"name": "Dna", "count": 1}, {"name": "Vrushabadri", "count": 1}],
        totalApartments: 31,
        singlePickupCount: 28
    },
    {
        rank: 3,
        area: "HSR Layout",
        bookings: 147,
        percentage: 4.5,
        areaDetails: {
            subAreas: ["S Colony", "Sector 3", "Muneswara Nagar", "New Extension", "Sector 6", "Sjr Park", "Peekayam Layout", "Eastwood Town"],
            roads: ["C Cross Road", "Ring Road", "A Main Road", "Somasundarapalya Main Road", "6Th Main", "5Th Cross Road"],
            landmarks: ["Agara Bus Stop"]
        },
        apartmentsHigh: [{"name": "Hsr Layout", "count": 10}, {"name": "Hsr Layout", "count": 8}, {"name": "Hsr Layout", "count": 6}, {"name": "Hsr Layout", "count": 4}, {"name": "St Block Hsr", "count": 3}, {"name": "Hsr Layout", "count": 3}],
        apartmentsMedium: [{"name": "Nd Sector Hsr", "count": 2}, {"name": "Th Sector Hsr", "count": 2}],
        apartmentsSingle: [{"name": "Block Koramangala Hsr", "count": 1}, {"name": "Hsr Layout", "count": 1}, {"name": "Beauty Salon Garden", "count": 1}, {"name": "St Sector Hsr", "count": 1}, {"name": "Agara", "count": 1}, {"name": "Block Koramangala Hsr", "count": 1}, {"name": "St Sector Hsr", "count": 1}, {"name": "St Sector Hsr", "count": 1}, {"name": "Hsr Layout", "count": 1}, {"name": "New Extension Hsr", "count": 1}, {"name": "Nd Sector Hsr", "count": 1}, {"name": "Elegance Somasundarapalya Hsr", "count": 1}, {"name": "Purva Fairmont", "count": 1}, {"name": "Th Sector Hsr", "count": 1}, {"name": "Agara Bus Stop Agara", "count": 1}, {"name": "Block Koramangala Hsr", "count": 1}, {"name": "Hsr Layout", "count": 1}, {"name": "Agara Lake Agara", "count": 1}, {"name": "Hsr Layout", "count": 1}, {"name": "St Sector Hsr", "count": 1}, {"name": "Hsr Layout", "count": 1}, {"name": "Layout Main Iti", "count": 1}, {"name": "Layout Rd Garden", "count": 1}, {"name": "Bsr Mantralaya Iti", "count": 1}],
        totalApartments: 32,
        singlePickupCount: 24
    },
    {
        rank: 4,
        area: "Marathahalli",
        bookings: 142,
        percentage: 4.3,
        areaDetails: {
            subAreas: ["Ambedkar Nagar", "Manjunatha Layout", "Rajasree Layout", "Pr Layout", "Ashwath Nagar", "Aswath Nagar", "Pragathi Layout", "Jawahar Nagar"],
            roads: ["2Nd Main", "9Th Main", "2Nd Cross Road", "1St Cross", "Ring Road", "Marathahalli Main Road"],
            landmarks: ["Kaikondrahalli Bus Stop", "Near Kauvery Hospital", "Near Motherhood Hospital"]
        },
        apartmentsHigh: [],
        apartmentsMedium: [{"name": "St Sector Hsr", "count": 2}],
        apartmentsSingle: [{"name": "Marathahalli Road Kaikondrahalli", "count": 1}, {"name": "Suvarnaraju", "count": 1}, {"name": "Kaveri Layout Marathahalli", "count": 1}, {"name": "Lakshminarayana Pura Aecs", "count": 1}, {"name": "Manjunatha Layout Marathahalli", "count": 1}, {"name": "Sattva Senorita Salarpuria", "count": 1}, {"name": "Ajr Plaza Rainbow", "count": 1}, {"name": "Purva Fountain Square Hal Old Airport", "count": 1}, {"name": "Rajatha Enclave Kaveri", "count": 1}, {"name": "Salarpuria Sanctity Sarjapur", "count": 1}, {"name": "Koushika Enclave Felice", "count": 1}, {"name": "Block Aecs", "count": 1}],
        totalApartments: 13,
        singlePickupCount: 12
    },
    {
        rank: 5,
        area: "Electronic City",
        bookings: 111,
        percentage: 3.4,
        areaDetails: {
            subAreas: ["Muniswamy Layout", "City Phase 2", "Lavakusha Nagar", "Chennakeshava Nagar", "Nelladri Nagar", "Btm Phase 1", "Road Phase 2", "Sunrise Park"],
            roads: ["Cross Street", "Shantipura Road", "2Nd Cross Road", "Village Road", "City Road", "Service Road"],
            landmarks: []
        },
        apartmentsHigh: [{"name": "Electronic City", "count": 9}, {"name": "Electronic City", "count": 3}, {"name": "Electronic City", "count": 3}],
        apartmentsMedium: [{"name": "S A Residency", "count": 2}, {"name": "Electronic City Phase Ii", "count": 2}],
        apartmentsSingle: [{"name": "Nisarga", "count": 1}, {"name": "Neeladri Investment", "count": 1}, {"name": "Fortune Munireddy", "count": 1}, {"name": "Shriram Signiaa", "count": 1}, {"name": "Temple Green House", "count": 1}, {"name": "Prestige Sunrise Park Birchwood Neotown", "count": 1}, {"name": "Celebrity", "count": 1}, {"name": "Birchwood", "count": 1}, {"name": "Celebrity", "count": 1}, {"name": "Chikkathoguru Konappana Agrahara", "count": 1}, {"name": "Apartment Inside Vasundhara", "count": 1}, {"name": "Electronic City", "count": 1}, {"name": "Tech City Layout Celebrity", "count": 1}, {"name": "Electronic City", "count": 1}, {"name": "Sobha Silicon Oasis Hosa", "count": 1}, {"name": "Ii Doddathoguru", "count": 1}, {"name": "Shriram Summitt Electronic City", "count": 1}, {"name": "Electronic City", "count": 1}, {"name": "Sobha Silicon Oasis Hosa", "count": 1}, {"name": "Electronic City", "count": 1}, {"name": "Vaibhav Reddy Building Doddathoguru", "count": 1}, {"name": "Kammasandra Electronic City", "count": 1}, {"name": "Celebrity", "count": 1}, {"name": "Square Glass Factory", "count": 1}, {"name": "Concorde Silicon Valley", "count": 1}],
        totalApartments: 30,
        singlePickupCount: 25
    },
    {
        rank: 6,
        area: "Bellandur",
        bookings: 94,
        percentage: 2.9,
        areaDetails: {
            subAreas: ["Verdant Phase 2", "Ambedkar Nagar", "Raju Colony", "Abhiram Enclave", "Freesia Enclave", "Chawdeshri Layout", "Boga Colony", "Vars Park"],
            roads: ["Bellandur Main Road", "2Nd Cross Road", "Layouts Road", "Ring Road", "Devarabisanahalli Road", "6Th Main"],
            landmarks: ["Aet Junction", "Aet Circle", "Near Ranganatha Swamy Temple", "Near Motherhood Hospital"]
        },
        apartmentsHigh: [{"name": "Adarsh Palm", "count": 4}],
        apartmentsMedium: [{"name": "Behind Adarsh Palm Retreat", "count": 2}, {"name": "Green Glen", "count": 2}, {"name": "Avenue Green Glen", "count": 2}],
        apartmentsSingle: [{"name": "Muni Reddy Garden Adarsh Palm", "count": 1}, {"name": "Near Embassy Tech", "count": 1}, {"name": "Avenue Green Glen", "count": 1}, {"name": "Raju Colony Yemalur Bellandur", "count": 1}, {"name": "Adarsh Palm", "count": 1}, {"name": "Aquamarine Green Glen", "count": 1}, {"name": "Lakshmi", "count": 1}, {"name": "Prabha", "count": 1}, {"name": "Avenue Green Glen", "count": 1}, {"name": "Embassy Pristine Suncity", "count": 1}, {"name": "Carmelaram Janatha", "count": 1}, {"name": "Reflection Green Glen", "count": 1}, {"name": "Prestige Kew", "count": 1}, {"name": "Vars Parkwood Adarsh Palm", "count": 1}, {"name": "Hibiscus Green Glen", "count": 1}, {"name": "Avenue Green Glen", "count": 1}, {"name": "Avenue Green Glen", "count": 1}, {"name": "Jharoka Phase Ii Yamalur", "count": 1}, {"name": "Oceanus Freesia", "count": 1}, {"name": "Abhiram Enclave Lake View", "count": 1}, {"name": "Avenue Green Glen", "count": 1}, {"name": "Adarsh Palm Retreat Adarsh Palm", "count": 1}, {"name": "Raju Colony Yamalur Bellandur", "count": 1}, {"name": "Avenue Green Glen", "count": 1}, {"name": "Sobha Insignia", "count": 1}],
        totalApartments: 29,
        singlePickupCount: 25
    },
    {
        rank: 7,
        area: "Varthur",
        bookings: 71,
        percentage: 2.2,
        areaDetails: {
            subAreas: ["Patel Layout", "Garden Layout", "Sankalpa Layout", "Chinnappa Layout", "Prakash Layout", "Woodside Park", "Paradise Layout", "Aecs Layout"],
            roads: ["Whitefield Main Road", "Opulent Road", "1St Cross", "Panathur Main Road", "Signature Road", "Varthur Road"],
            landmarks: ["Near Varthur Police Station", "Opposite To Sahasra Hospital 560087"]
        },
        apartmentsHigh: [{"name": "Sobha Dream Acres Balagere", "count": 8}],
        apartmentsMedium: [{"name": "Brigade Cornerstone Utopia Varthur Rd", "count": 2}, {"name": "Prestige Lakeside Habitat", "count": 2}, {"name": "Brigade Cornerstone Utopia Varthur", "count": 2}, {"name": "Brigade Cornerstone Utopia Varthur", "count": 2}],
        apartmentsSingle: [{"name": "Apartment Complex", "count": 1}, {"name": "Sobha Dream Acres Balagere", "count": 1}, {"name": "Krishnasiri", "count": 1}, {"name": "Sankalpa Layout Varthur", "count": 1}, {"name": "Sobha Dream Acres", "count": 1}, {"name": "Utopia Varthur Rd Varthur", "count": 1}, {"name": "Prakash Layout Varthur", "count": 1}, {"name": "Brigade Cornerstone Utopia", "count": 1}, {"name": "Brigade Cornerstone Utopia Varthur Rd", "count": 1}],
        totalApartments: 14,
        singlePickupCount: 9
    },
    {
        rank: 8,
        area: "BTM Layout",
        bookings: 68,
        percentage: 2.1,
        areaDetails: {
            subAreas: ["In Town", "Btm Phase 1", "Sunshine Colony", "New Extension", "Heights Layout", "Aicobo Nagar", "Scheme Colony", "Officers Colony"],
            roads: ["7Th Main", "1St Cross", "A Main Road", "28Th Main", "18Th Main Road", "14Th Main"],
            landmarks: ["Behind Orchid International School Gate", "Opposite Apollo Pharmacy Bilekahalli Btm 560076"]
        },
        apartmentsHigh: [{"name": "Nd Stage Btm", "count": 13}, {"name": "St Stage Btm", "count": 3}],
        apartmentsMedium: [{"name": "Btm Layout", "count": 2}, {"name": "Galaxy", "count": 2}, {"name": "Nd Stage Btm", "count": 2}, {"name": "Brighton Dollar", "count": 2}],
        apartmentsSingle: [{"name": "Btm Layout", "count": 1}, {"name": "Pride Kas Officers", "count": 1}, {"name": "Aradhana", "count": 1}, {"name": "Nd Stage Btm", "count": 1}, {"name": "St Stage Btm", "count": 1}, {"name": "St Stage Btm", "count": 1}, {"name": "Emerald Kas Officers", "count": 1}, {"name": "Aryan", "count": 1}, {"name": "Nd Btm", "count": 1}, {"name": "Nd Stage Btm", "count": 1}],
        totalApartments: 16,
        singlePickupCount: 10
    },
    {
        rank: 9,
        area: "Koramangala",
        bookings: 59,
        percentage: 1.8,
        areaDetails: {
            subAreas: ["S Colony", "Bed Layout", "Sbi Colony", "Swamy Enclave", "Mig Colony", "Sidharata Colony", "Reddy Layout", "Austin Town"],
            roads: ["9Th Cross Road", "C Cross Road", "1St Cross", "Ring Road", "A Main Road", "6Th Main"],
            landmarks: []
        },
        apartmentsHigh: [],
        apartmentsMedium: [{"name": "Th Block Koramangala", "count": 2}],
        apartmentsSingle: [{"name": "Nd Block Koramangala", "count": 1}, {"name": "Bed Cauvery", "count": 1}, {"name": "Bed Cauvery", "count": 1}, {"name": "Th Block Koramangala", "count": 1}, {"name": "Rd Block", "count": 1}, {"name": "Th Block Koramangala Koramangala", "count": 1}, {"name": "Regency Nirguna Mandir", "count": 1}, {"name": "St Block Koramangala Koramangala", "count": 1}, {"name": "Vilas Pawar Khb", "count": 1}, {"name": "Complex Khb Games Village", "count": 1}, {"name": "Khb Mig", "count": 1}, {"name": "Khb Games", "count": 1}, {"name": "Sahana Nilaya", "count": 1}, {"name": "Madiwala Underpass Sidharata", "count": 1}, {"name": "St Block Koramangala Koramangala", "count": 1}],
        totalApartments: 16,
        singlePickupCount: 15
    },
    {
        rank: 10,
        area: "Indiranagar",
        bookings: 50,
        percentage: 1.5,
        areaDetails: {
            subAreas: ["Indira Nagar", "Vignan Nagar", "Kondappa Layout", "Channakesahava Nagar", "Hoysala Nagar", "Super Town", "Bda Colony", "Defence Colony"],
            roads: ["1St Cross", "A Main Road", "6Th Cross", "3Rd Cross Road", "19Th Main", "15Th Cross Road"],
            landmarks: []
        },
        apartmentsHigh: [],
        apartmentsMedium: [],
        apartmentsSingle: [{"name": "Indus Signature", "count": 1}, {"name": "Stage Indiranagar Bda", "count": 1}],
        totalApartments: 2,
        singlePickupCount: 2
    },
    {
        rank: 11,
        area: "Brookefield",
        bookings: 50,
        percentage: 1.5,
        areaDetails: {
            subAreas: ["Garden Layout", "Kundalahalli Colony", "Domain Layout", "Krest Phase 3", "Udupi Park", "Layout Phase 2", "Dikshith Enclave", "Reddy Layout"],
            roads: ["9Th Cross Road", "3Rd Main Road", "Layout Main Road", "Marathahalli Main Road", "6Th Main", "3Rd Cross Road"],
            landmarks: []
        },
        apartmentsHigh: [{"name": "Beml Layout Brookefield", "count": 6}],
        apartmentsMedium: [{"name": "Phase 2 Brookefield Bengaluru Karnataka India", "count": 2}],
        apartmentsSingle: [{"name": "Sreenivas Reddy", "count": 1}],
        totalApartments: 3,
        singlePickupCount: 1
    },
    {
        rank: 12,
        area: "Kadugodi",
        bookings: 48,
        percentage: 1.5,
        areaDetails: {
            subAreas: ["Prasanth Extension", "Prestige Park", "New Extension", "Crimson Layout", "Belatur Colony", "Hamlet Layout", "Maithri Layout", "Gopalkrishna Nagar"],
            roads: ["7Th Main Road", "Channasandra Main Road", "Whitefield Main Road", "7Th Main", "2Nd Main Road", "Kodigehalli Main Road"],
            landmarks: ["Farm Circle", "Near By Sai Baba Temple"]
        },
        apartmentsHigh: [],
        apartmentsMedium: [],
        apartmentsSingle: [{"name": "Siddhartha Layout Kadugodi", "count": 1}, {"name": "Homes Crimson", "count": 1}, {"name": "Reddy Colony Kadugodi", "count": 1}, {"name": "Vsr Layout Maithri", "count": 1}, {"name": "Pavani Maithri", "count": 1}, {"name": "Maithri Layout Kadugodi", "count": 1}, {"name": "Reddy Colony Kadugodi", "count": 1}, {"name": "Green Valley Kadugodi", "count": 1}, {"name": "Prabhavathi Elegant Apartment", "count": 1}, {"name": "Kadugodi Flyover Belatur", "count": 1}, {"name": "Maithri Layout Kadugodi", "count": 1}, {"name": "Belathur Colony Kadugodi", "count": 1}, {"name": "Residency Patalamma", "count": 1}, {"name": "Internal Rd Kadugodi", "count": 1}],
        totalApartments: 14,
        singlePickupCount: 14
    },
    {
        rank: 13,
        area: "Sarjapur",
        bookings: 47,
        percentage: 1.4,
        areaDetails: {
            subAreas: ["Ambedkar Nagar", "Garden Layout", "Valliyamma Layout", "Bird Layout", "Hsr Layout", "Amrita Nagar", "Serenity Layout", "Narayana Nagar"],
            roads: ["Sarjapura Main Road", "Attibele Road", "Hosa Road", "Outer Ring Road", "Ring Road", "Marathahalli Road"],
            landmarks: ["Near Anjaneya Temple", "Kaikondrahalli Bus Stop", "Opposite Mcdonalds Bengaluru Karnataka India", "Near Motherhood Hospital"]
        },
        apartmentsHigh: [],
        apartmentsMedium: [],
        apartmentsSingle: [{"name": "Shriram Malhaar Sarjapur Hobli Ittangur", "count": 1}, {"name": "Peninsula Solitaire", "count": 1}, {"name": "Dew Marythi Garden", "count": 1}],
        totalApartments: 3,
        singlePickupCount: 3
    },
    {
        rank: 14,
        area: "Kadubeesanahalli",
        bookings: 36,
        percentage: 1.1,
        areaDetails: {
            subAreas: ["Munireddy Layout", "Appanreddy Layout", "Mariyappa Layout", "Kaverappa Layout"],
            roads: ["Panathur Main Road", "Station Road", "2Nd Cross Road", "Outer Ring Road", "Agrahara Road", "Varthur Road"],
            landmarks: ["Near Jyothi English School"]
        },
        apartmentsHigh: [],
        apartmentsMedium: [],
        apartmentsSingle: [{"name": "Prestige Tech Vista Kadubeesanahalli", "count": 1}, {"name": "Kaverappa Layout Kadubeesanahalli", "count": 1}, {"name": "Krishna", "count": 1}],
        totalApartments: 3,
        singlePickupCount: 3
    },
    {
        rank: 15,
        area: "JP Nagar",
        bookings: 34,
        percentage: 1.0,
        areaDetails: {
            subAreas: ["Annapoorneshwari Layout", "City Layout", "Residency Layout", "Kr Layout", "Reddy Layout", "Pallavi Enclave", "Royal Park", "Devaraya Nagar"],
            roads: ["2Nd Cross Road", "1St Cross", "Kanakapura Main Road", "28Th Main", "24Th Main Road", "16Th Main"],
            landmarks: ["Sarakki Signal"]
        },
        apartmentsHigh: [],
        apartmentsMedium: [{"name": "Annaiah Reddy", "count": 2}],
        apartmentsSingle: [{"name": "Millenium Rd Lakshmi", "count": 1}, {"name": "Ms Ramaiah City", "count": 1}, {"name": "Century Pragati", "count": 1}],
        totalApartments: 4,
        singlePickupCount: 3
    }
];

        // Function to create area breakdown section
        function createAreaSection(areaDetails) {
            let html = '';
            
            if (areaDetails.subAreas && areaDetails.subAreas.length > 0) {
                html += '<div class="area-section">';
                html += '<div class="area-section-header sub-areas">üèòÔ∏è Sub-areas</div>';
                html += areaDetails.subAreas.slice(0, 6).map(area => 
                    `<span class="area-item sub-area">${area}</span>`
                ).join(' ');
                if (areaDetails.subAreas.length > 6) {
                    html += `<span class="area-item" style="background:#ddd; font-style:italic;">+${areaDetails.subAreas.length - 6} more</span>`;
                }
                html += '</div>';
            }
            
            if (areaDetails.roads && areaDetails.roads.length > 0) {
                html += '<div class="area-section">';
                html += '<div class="area-section-header roads">üõ£Ô∏è Roads</div>';
                html += areaDetails.roads.slice(0, 4).map(road => 
                    `<span class="area-item road">${road}</span>`
                ).join(' ');
                if (areaDetails.roads.length > 4) {
                    html += `<span class="area-item" style="background:#ddd; font-style:italic;">+${areaDetails.roads.length - 4} more</span>`;
                }
                html += '</div>';
            }
            
            if (areaDetails.landmarks && areaDetails.landmarks.length > 0) {
                html += '<div class="area-section">';
                html += '<div class="area-section-header landmarks">üìç Landmarks</div>';
                html += areaDetails.landmarks.slice(0, 3).map(landmark => 
                    `<span class="area-item landmark">${landmark}</span>`
                ).join(' ');
                html += '</div>';
            }
            
            return html || '<div style="color:#999; font-style:italic;">No specific area data available</div>';
        }

        // Function to create apartment section with show more functionality
        function createApartmentSection(apartments, sectionClass, sectionTitle, areaId) {
            if (apartments.length === 0) return '';
            
            let html = `<div class="section-header ${sectionClass}">${sectionTitle}</div>`;
            
            const visibleApts = apartments.slice(0, 10);
            const hiddenApts = apartments.slice(10);
            
            html += visibleApts.map(apt => 
                `<span class="apartment-item ${sectionClass}-pickup">${apt.name}<span class="apartment-count">${apt.count}</span></span>`
            ).join(' ');
            
            if (hiddenApts.length > 0) {
                const hiddenId = `hidden-${areaId}-${sectionClass}`;
                html += `<span class="hidden-apartments" id="${hiddenId}">`;
                html += hiddenApts.map(apt => 
                    `<span class="apartment-item ${sectionClass}-pickup">${apt.name}<span class="apartment-count">${apt.count}</span></span>`
                ).join(' ');
                html += '</span>';
                
                html += `<button class="show-more-btn" onclick="toggleShowMore('${hiddenId}', this)">
                    <i class="fas fa-plus"></i> Show ${hiddenApts.length} more
                </button>`;
            }
            
            return html;
        }

        function toggleShowMore(hiddenId, button) {
            const hiddenSection = document.getElementById(hiddenId);
            const isShowing = hiddenSection.classList.contains('show');
            
            if (isShowing) {
                hiddenSection.classList.remove('show');
                const hiddenCount = hiddenSection.querySelectorAll('.apartment-item').length;
                button.innerHTML = `<i class="fas fa-plus"></i> Show ${hiddenCount} more`;
            } else {
                hiddenSection.classList.add('show');
                button.innerHTML = `<i class="fas fa-minus"></i> Show less`;
            }
        }

        function populateTable(data = pickupData) {
            const tableBody = document.getElementById('tableBody');
            tableBody.innerHTML = '';

            data.forEach(item => {
                const row = document.createElement('tr');
                
                const areasHtml = createAreaSection(item.areaDetails);
                
                let apartmentsHtml = '';
                
                apartmentsHtml += `<div class="stats-summary">
                    <strong>${item.totalApartments}</strong> total apartments | 
                    <span style="color:#27ae60">${item.apartmentsHigh.length}</span> high pickup | 
                    <span style="color:#f39c12">${item.apartmentsMedium.length}</span> medium pickup | 
                    <span style="color:#95a5a6">${item.singlePickupCount}</span> single pickup
                </div>`;
                
                const areaId = `area-${item.rank}`;
                
                apartmentsHtml += createApartmentSection(
                    item.apartmentsHigh, 
                    'high', 
                    'üî• High Pickup (3+)', 
                    areaId
                );
                
                apartmentsHtml += createApartmentSection(
                    item.apartmentsMedium, 
                    'medium', 
                    'üìà Medium Pickup (2)', 
                    areaId
                );
                
                apartmentsHtml += createApartmentSection(
                    item.apartmentsSingle, 
                    'single', 
                    'üè† Single Pickup (1)', 
                    areaId
                );

                row.innerHTML = `
                    <td class="rank-cell">${item.rank}</td>
                    <td class="area-name">${item.area}</td>
                    <td class="bookings">${item.bookings} <span class="percentage">(${item.percentage}%)</span></td>
                    <td class="areas-column">${areasHtml}</td>
                    <td class="apartments">${apartmentsHtml}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        document.getElementById('searchInput').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            
            if (searchTerm === '') {
                populateTable();
                return;
            }

            const filteredData = pickupData.filter(item => {
                if (item.area.toLowerCase().includes(searchTerm)) return true;
                
                const areaDetails = item.areaDetails;
                if (areaDetails.subAreas.some(area => area.toLowerCase().includes(searchTerm))) return true;
                if (areaDetails.roads.some(road => road.toLowerCase().includes(searchTerm))) return true;
                if (areaDetails.landmarks.some(landmark => landmark.toLowerCase().includes(searchTerm))) return true;
                
                return item.apartmentsHigh.some(apt => apt.name.toLowerCase().includes(searchTerm)) ||
                       item.apartmentsMedium.some(apt => apt.name.toLowerCase().includes(searchTerm)) ||
                       item.apartmentsSingle.some(apt => apt.name.toLowerCase().includes(searchTerm));
            });

            populateTable(filteredData);
        });

        function exportToExcel() {
            const ws_data = [
                ['Rank', 'Area Name', 'Total Bookings', 'Percentage', 'Sub-Areas', 'Roads', 'Landmarks', 'Total Apartments', 'All Apartment Names (Clean)']
            ];

            pickupData.forEach(item => {
                const allApartments = [
                    ...item.apartmentsHigh.map(apt => `${apt.name} (${apt.count})`),
                    ...item.apartmentsMedium.map(apt => `${apt.name} (${apt.count})`),
                    ...item.apartmentsSingle.map(apt => `${apt.name} (${apt.count})`),
                ].join(' | ');
                
                ws_data.push([
                    item.rank,
                    item.area,
                    item.bookings,
                    `${item.percentage}%`,
                    item.areaDetails.subAreas.join(', '),
                    item.areaDetails.roads.join(', '),
                    item.areaDetails.landmarks.join(', '),
                    item.totalApartments,
                    allApartments
                ]);
            });

            const wb = XLSX.utils.book_new();
            const ws = XLSX.utils.aoa_to_sheet(ws_data);

            ws['!cols'] = [
                { wch: 8 }, { wch: 20 }, { wch: 15 }, { wch: 12 }, 
                { wch: 40 }, { wch: 40 }, { wch: 40 }, { wch: 15 }, { wch: 100 }
            ];

            XLSX.utils.book_append_sheet(wb, ws, "Clean Apartment Names");

            const now = new Date();
            const filename = `Bangalore_Clean_Apartments_${now.getFullYear()}-${(now.getMonth()+1).toString().padStart(2,'0')}-${now.getDate().toString().padStart(2,'0')}.xlsx`;

            XLSX.writeFile(wb, filename);
        }

        document.addEventListener('DOMContentLoaded', function() {
            populateTable();
        });
    </script>
</body>
</html>